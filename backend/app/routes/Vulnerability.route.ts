import { VulnerabilityController } from "../controllers";
import { Router } from "./Router";

export class VulnerabilityRouter extends Router {
    constructor() {
        super(VulnerabilityController);
        this.router
            .get("/", this.handler(VulnerabilityController.prototype.all))
            .get("/vulnerabilities", this.handler(VulnerabilityController.prototype.all))
            .get("/products", this.handler(VulnerabilityController.prototype.getProducts))
            .get("/vendors", this.handler(VulnerabilityController.prototype.getVendors))
            .get("/vulnerabilities/cve/:cveId", this.handler(VulnerabilityController.prototype.findByCveId))
            .get("/vulnerabilities/product/:product", this.handler(VulnerabilityController.prototype.findByProduct))
            .get("/vulnerabilities/vendor/:vendor", this.handler(VulnerabilityController.prototype.findByVendor))
            .post("/create", this.handler(VulnerabilityController.prototype.create))
            .put("/update/:date", this.handler(VulnerabilityController.prototype.update));
    }
}
