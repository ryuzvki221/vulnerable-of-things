import { Entity, PrimaryGeneratedColumn, Column, OneToMany } from 'typeorm';
import { Metric } from './Metric.model';
import { Weakness } from './Weakness.model';
import { Configuration } from './Configuration.model';
import { Reference } from './Reference.model';

@Entity()
export class Vulnerability {
  @PrimaryGeneratedColumn()
  id: number;

  @Column({ nullable: true })
  cveId: string;


  @Column({ nullable: true })
  vendor: string;

  @Column({ nullable: true })
  product: string;

  @Column({ nullable: true })
  sourceIdentifier: string;

  @Column({ nullable: true })
  published: Date;

  @Column({ nullable: true })
  lastModified: Date;

  @Column({ nullable: true })
  description: string;

  @OneToMany(() => Metric, metric => metric.vulnerability, {
    cascade: true,
    nullable: true,
  })
  metrics: Metric[];

  @OneToMany(() => Weakness, weakness => weakness.vulnerability, {
    cascade: true,
    nullable: true,
  })
  weaknesses: Weakness[];

  @OneToMany(() => Configuration, configuration => configuration.vulnerability, {
    cascade: true,
    nullable: true,
  })
  affected: Configuration[];

  @OneToMany(() => Reference, reference => reference.vulnerability, {
    cascade: true,
    nullable: true,
  })
  references: Reference[];
}